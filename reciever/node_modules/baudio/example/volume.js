var baudio = require('../');
var spawn = require('child_process').spawn;
var aplay = spawn('aplay', [ '-r', '44k', '-c', '2', '-f', 'S16_LE' ]);

var bucket = 0;

var step = 0;
var zero = false;

baudio(function (t) {
    var n = t;
    var f = 350;
    var x = Math.sin(n * f);
    var volume = (Math.sin(t) + 1) / 2;
    
    bucket ++;
    zero = bucket < 1 / volume;
    if (!zero) bucket = 0;
    
    return !zero * x;
}).pipe(aplay.stdin);
